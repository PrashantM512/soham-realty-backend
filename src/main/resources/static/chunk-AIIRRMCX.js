import{H as i,K as l,P as u,ac as c,f as a,m as n}from"./chunk-SRQFOZRN.js";var p=class s{constructor(r){this.http=r;let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{let o=JSON.parse(t);this.currentUserSubject.next(o)}catch(o){console.error("Error parsing stored user:",o),this.logout()}}apiUrl="http://localhost:8080/api/auth";currentUserSubject=new a(null);currentUser$=this.currentUserSubject.asObservable();login(r,e){return this.http.post(`${this.apiUrl}/login`,{email:r,password:e}).pipe(n(t=>t.data),i(t=>{localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),this.currentUserSubject.next(t.user)}))}register(r){return this.http.post(`${this.apiUrl}/register`,r).pipe(n(e=>e.data),i(e=>{localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user)),this.currentUserSubject.next(e.user)}))}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),this.currentUserSubject.next(null)}isAuthenticated(){return!!localStorage.getItem("token")}getToken(){return localStorage.getItem("token")}getCurrentUser(){return this.currentUserSubject.value}static \u0275fac=function(e){return new(e||s)(u(c))};static \u0275prov=l({token:s,factory:s.\u0275fac,providedIn:"root"})};export{p as a};
